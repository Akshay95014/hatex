%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Structured General Purpose Assignment
% LaTeX Template
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original author:
% Ted Pavlic (http://www.tedpavlic.com)
%
% Note:
% The \lipsum[#] commands throughout this template generate dummy text
% to fill the template out. These commands should all be removed when 
% writing assignment content.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%       PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage{graphicx} % Required to insert images
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

\usepackage{amsmath}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in 

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkAuthorName} % Top left header
\chead{\hmwkClass\ : \hmwkTitle} % Top center header
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%       DOCUMENT STRUCTURE COMMANDS
%       Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems

\newcommand{\homeworkProblemName}{}
\newenvironment{homeworkProblem}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
\stepcounter{homeworkProblemCounter} % Increase counter for number of problems
\renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the name of the problem
\section{\homeworkProblemName} % Make a section in the document with the custom problem count
\enterProblemHeader{\homeworkProblemName} % Header and footer within the environment
}{
\exitProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
\noindent\framebox[\columnwidth][c]{\begin{minipage}{0.98\columnwidth}#1\end{minipage}} % Makes the box around the problem answer and puts the content inside
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
\renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
\subsection{\homeworkSectionName} % Make a subsection with the custom name of the subsection
\enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header and footer within the environment
}{
\enterProblemHeader{\homeworkProblemName} % Header and footer after the environment
}
   
%----------------------------------------------------------------------------------------
%       NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Assignment\ \# } % Assignment title
\newcommand{\hmwkDueDate}{Monday,\ September\ 21,\ 2015} % Due date
\newcommand{\hmwkClass}{MATH-547} % Course/class
\newcommand{\hmwkClassTime}{} % Class/lecture time
\newcommand{\hmwkAuthorName}{Saket Choudhary} % Your name
\newcommand{\hmwkAuthorID}{2170058637} % Teacher/lecturer
%----------------------------------------------------------------------------------------
%       TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
\vspace{2in}
\textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
\normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate}\\
\vspace{0.1in}\large{\textit{\hmwkClassTime}}
\vspace{3in}
}

\author{\textbf{\hmwkAuthorName} \\
        \textbf{\hmwkAuthorID}
        }
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------
%       TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

%\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\newpage
\tableofcontents
\newpage


\begin{homeworkProblem}[Problem 1] % Roman numerals
%--------------------------------------------
		$(X,Y) \in {R}^d \times \{\pm 1\}$
		\begin{align*}
		P(Y=1) &= \pi_+\\
		P(Y=-1) &= \pi_-
		P(dx|Y=1) &= p_{+}(x)\\
		P(dx|Y=-1) &= p_{-}(x)
		\end{align*}
\begin{homeworkSection}{\homeworkProblemName: (a)} % Section within problem
	
\problemAnswer{ % Answer

Expression for bayes classifier:

\begin{align*}
P(Y=1|x)= \frac{P(x|Y=1)P(Y=1)}{P(x|Y=1)P(Y=1)+P(x|Y=-1)P(Y=-1)}\\
P(Y=1|x) = \frac{\pi_+ p_{+}(x)}{\pi_+ p_{+}(x)+\pi_-p_{-}(x)}
\end{align*}

\begin{align*}
P(Y=-1|x)= \frac{P(x|Y=-1)P(Y=1)}{P(x|Y=-1)P(Y=-1)+P(x|Y=-1)P(Y=-1)}\\
P(Y=-1|x) = \frac{\pi_- p_{-}(x)}{\pi_+ p_{+}(x)+\pi_-p_{-}(x)}
\end{align*}

Define $\eta(x) =  E[Y|x] = 1\times P(Y=1|x) + -1 \times P(Y=1|x) $

Now, 

\begin{align*}
P(error|x) = \begin{cases}
P(Y=1|x) & \text{if actual class for x is -1}\\
P(Y=-11|x) & \text{if actual class for x is 1}\\
\end{cases}
\end{align*}

Intuitively to minimise the error, we choose class '1' for $x$ when
$P(Y=1|x)>P(Y=-1|X)$

and hence, the bayes classifier $g_*(x)$ is given by:\\
\begin{align*}
g_*(x) = \begin{cases}
1 & \pi_+p_+(x) \geq \pi_{-}p_-(x)\\
-1 & \text{otherwise}
\end{cases}
\end{align*}
}

and the total probability of making an error is given by:
$P(error|x) = min(P(Y=1|x),P(Y=-1|x))$

The loss function $L(\alpha_i,\omega_j)$ is the 'loss' incurred for taking action $\alpha_i$ instead of $\omega_j$

\end{homeworkSection}



\begin{homeworkSection}{\homeworkProblemName: (b)} % Section within problem
	\problemAnswer{
		Bayes risk
		}
\end{homeworkSection}

\end{homeworkProblem}

\begin{homeworkProblem}[Problem 4]
	\problemAnswer{Assume the sufficient condition exists, i.e.:
		There exist $a_1,a_2, \dots a_k \geq 0$ and binary classifiers $g_1, g_2, \dots g_k$ such that $\forall 1 \leq i \leq n$:
		$Y_i\sum_{j=1}^k a_jg_j(X_i) \geq 2\gamma$
		
		
		$Y_i$ is given by the widghted sum of predictions $g_j$ : $Y_i = sign(\sum_{j=1}^k a_jg_j(X_i))$
		Taking expectations:
		\begin{align*}
		E[Y_i\sum_{j=1}^k a_jg_j(X_i)] \geq 2\gamma \\
		\sum_{j=1}^k a_j E[Y_ig_j(X_i)] \geq 2\gamma
		\end{align*}
		
		Since, $\sum_j a_j =1$ and $a_j \geq 0$ for $j= \{1,2,\dots,k\}$ and $\sum_{j=1}^k a_j E[Y_ig_j(X_i)] \geq 2\gamma$ then there exists a $g_j$ such that:
		
		$E[Y_ig_j(X_i)] \geq 2\gamma$
		
		\begin{align*}
		E[Y_ig_j(X_i)] &= 1\times P[Y_i=g_j(X_i)] + -1 \times P(Y_i \neq g_j(X_i))\\
		&= 1- 2P(Y_i \neq  g_j(X_i))\\
		\implies P(Y_i \neq  g_j(X_i)) = \frac{1-E[Y_ig_j(X_i)]}{2} \\
		P(Y_i \neq  g_j(X_i)) \leq \frac{1-2\gamma}{2}
		\end{align*}
		
		Now for weights, $w_1, w_2, \dots w_j$ such that $\sum_j w_j=1$:
		
		\begin{align*}
		\sum_{j=1}^n P(Y_j \neq g(X-j)) \leq \frac{1}{2}-\gamma \\
		\sum_{j=1}^n E[I(Y_j \neq g(X-j))] \leq \frac{1}{2}-\gamma \\
		\sum_{j=1}^n I(Y_j \neq g(X-j)) \leq \frac{1}{2}-\gamma \\
		\end{align*}
		}
\end{homeworkProblem}
\end{document}
